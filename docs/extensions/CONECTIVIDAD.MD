# üì° Documentaci√≥n de Conectividad y Estado de Red (Sync Strategy)

**Fecha de actualizaci√≥n:** 10 de Febrero de 2026  
**M√≥dulo:** `SyncBloc` / `AgencyHeader`  
**Paquete utilizado:** `connectivity_plus`

---

## 1. Estado Actual (Demo / MVP)

Actualmente, la aplicaci√≥n implementa una detecci√≥n de estado de conexi√≥n basada en la **Interfaz de Red del Dispositivo**.

### üõ†Ô∏è Comportamiento Implementado

El sistema escucha activamente los cambios en el hardware de red del dispositivo (WiFi, Datos M√≥viles, Ethernet) utilizando el paquete `connectivity_plus`.

* **üü¢ ONLINE:** Se activa cuando el dispositivo tiene una conexi√≥n establecida a una red (ej. WiFi conectado, Datos M√≥viles activos).
* **üî¥ OFFLINE:** Se activa cuando no hay ninguna interfaz de red disponible (ej. Modo Avi√≥n, WiFi apagado).

### ‚ö†Ô∏è Limitaci√≥n T√©cnica (Alcance Actual)

La implementaci√≥n actual verifica la **conexi√≥n a la red local**, no la **salida a Internet**.

> **Ejemplo:** Si el dispositivo est√° conectado a un Router WiFi, pero ese Router no tiene servicio de internet (cable desconectado), la aplicaci√≥n marcar√° el estado como **ONLINE** (porque la interfaz WiFi est√° activa), aunque no pueda comunicarse con la API de OthliAni.

---

## 2. Implementaci√≥n Futura (Roadmap a Producci√≥n)

Para garantizar la sincronizaci√≥n de datos cr√≠tica en entornos reales (Agencias y Gu√≠as en campo), se debe evolucionar la estrategia de conectividad para incluir una verificaci√≥n de **"Internet Reachability"**.

### üöÄ Mejora Requerida: "Ping Check" o "Health Check"

En la siguiente fase de desarrollo, el `SyncBloc` deber√° implementar una doble verificaci√≥n:

1. **Nivel 1 (Hardware):** Verificar si hay red (lo que ya hace `connectivity_plus`).
2. **Nivel 2 (Servicio):** Si hay red, realizar una petici√≥n ligera (Ping/Head Request) a un servidor confiable o al propio Backend de OthliAni.

### üìù Propuesta de Implementaci√≥n T√©cnica

Se recomienda utilizar el paquete `internet_connection_checker` o implementar una funci√≥n personalizada de `Socket` en Dart:

```dart
// Pseudo-c√≥digo para futura implementaci√≥n
bool hasInternet = await InternetConnectionChecker().hasConnection;

if (hasNetworkInterface && hasInternet) {
  emit(SyncStatus.online); // Realmente tenemos internet
} else if (hasNetworkInterface && !hasInternet) {
  emit(SyncStatus.limited); // Conectado al WiFi pero sin salida
} else {
  emit(SyncStatus.offline); // Sin red
}
